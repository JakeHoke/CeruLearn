<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Fetch API Client</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.js"></script>
</head>
<body>
    <script>
        const SECRET_KEY = "16_byte_secrt_ky";

        function encryptAES(plainText, key) {
            const iv = CryptoJS.lib.WordArray.random(128 / 8);
            const encrypted = CryptoJS.AES.encrypt(plainText, CryptoJS.enc.Utf8.parse(key), { iv: iv });
            return iv.toString(CryptoJS.enc.Base64) + encrypted.toString();
        }

        async function sendData() {
            const dataStr = "Hello, Server!";
            
            // Encrypt the data using AES and CryptoJS
            const encryptedData = encryptAES(dataStr, SECRET_KEY);
            console.log(encryptedData);

            // Send encrypted blob to the server
            const response = await fetch('https://cerubase.cerulearnadmin.repl.co/data', {
                method: 'POST',
                body: encryptedData
            });

            const result = await response.json();
            console.log(result);
        }

        // Send data when the page loads
        window.onload = sendData;
    </script>
</body>
</html>
